<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width">

    <link rel="alternate" type="application/rss+xml" title="Jeremy Tuloup's Blog" href="http://www.jtp.io/feed.xml">

    <title>Jeremy Tuloup's Blog - Thoughts on Project Euler problem 57</title>

    <link rel="canonical" href="http://www.jtp.io/2015/04/18/project-euler-57.html" />
    <link rel="shortcut icon" type="image/png" href="favicon.png"/>

    <!-- Bootstrap core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootswatch/3.3.5/yeti/bootstrap.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min.css">
    <style>
      .MathJax_Preview { color: #888 }
      .math_finished .MathJax_Preview { display: none }
    </style>

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>

  <body>
    <div id="top" class="container">

<div class="row top">
  <div class="col-md-12 col-xs-18 col-sm-12">
    <a href="/" class="btn btn-default" title="Home">JTP</a>
    
      
        
      
        
      
        
      
        
          
            <a href="/index.html" class="btn btn-primary">Blog</a>
          
        
      
    
      
        
      
        
      
        
          
            <a href="/gameJams.html" class="btn btn-primary">Game Jams</a>
          
        
      
        
      
    
      
        
          
            <a href="/about.html" class="btn btn-primary">About</a>
          
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
    
    <a href="//github.com/jtpio" class="btn btn-primary" title="Github"><i class="fa fa-github-square fa-1x"></i></a>
    <a href="//twitter.com/jtpio" class="btn btn-primary" title="Twitter"><i class="fa fa-twitter-square fa-1x"></i></a>
    <a href="//www.linkedin.com/in/jtuloup" class="btn btn-primary" title="LinkedIn"><i class="fa fa-linkedin-square fa-1x"></i></a>
  </div>
</div>


<div class="row">
  <div class="col-md-12 col-xs-18 col-sm-12">
	  <h2> <strong> Thoughts on Project Euler problem 57 </strong> &ndash; April 18, 2015 </h2>
<h4>

	<span class="label label-default">math</span>

	<span class="label label-default">algorithms</span>

	<span class="label label-default">python</span>

</h4>

<p>I haven’t visited the <a href="https://projecteuler.net/">Project Euler</a> website for a while. But they recently announced new awards (trophies), for example the <em>Flawless Fifty</em> for 50 consecutive problems (this one is done!) and <em>C for Commitment</em> for solving the first 100 problems (feasible).</p>

<p>So I picked one of the problems I hadn’t done before just for fun: <a href="https://projecteuler.net/problem=57">Problem 57</a></p>

<p>The statement is as follow:</p>

<p>It is possible to show that the square root of two can be expressed as an infinite continued fraction.</p>

<script type="math/tex; mode=display">\sqrt 2 = 1 + \frac{1}{2 + \frac{1}{2 + \frac{1}{2 + ... }}} = 1.414213...</script>

<p>By expanding this for the first four iterations, we get:</p>

<script type="math/tex; mode=display"> 1 + \frac{1}{2} = \frac{3}{2} = 1.5 </script>

<script type="math/tex; mode=display"> 1 + \frac{1}{2 + \frac{1}{2}} = \frac{7}{5} = 1.4 </script>

<script type="math/tex; mode=display"> 1 + \frac{1}{2 + \frac{1}{2 + \frac{1}{2}}} = \frac{17}{12} = 1.41666... </script>

<script type="math/tex; mode=display"> 1 + \frac{1}{2 + \frac{1}{2 + \frac{1}{2 + \frac{1}{2}}}} = \frac{41}{29} = 1.41379... </script>

<p>The next three expansions are 99/70, 239/169, and 577/408, but the eighth expansion, 1393/985, is the first example where the number of digits in the numerator exceeds the number of digits in the denominator.</p>

<p>In the first one-thousand expansions, how many fractions contain a numerator with more digits than denominator?</p>

<h2 id="first-solution">First solution</h2>

<p>I usually love using Python for solving these kind of problems, as the solution ends up being simple to read and very elegant.</p>

<p>Python has support for fractions thanks to the <code>fractions</code> package, so let’s use it!
Putting the <em>1</em> appart for now, we can see that the first term is <script type="math/tex"> a_0 = \frac{1}{2} </script>, and the second is <script type="math/tex"> a_1 = \frac{1}{2 + \frac{1}{2}} </script>, which is the same as <script type="math/tex"> a_1 = \frac{1}{ 2 + a_0 } </script>. Then by construction, <script type="math/tex"> a_{n+1} = \frac{1}{2 + a_n} </script></p>

<p>With the fractions module, it is very easy to access the numerator and denominator.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>

<span class="n">res</span><span class="p">,</span> <span class="n">an</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1001</span><span class="p">):</span>
    <span class="n">an</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">an</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">an</span> <span class="o">+</span> <span class="mi">1</span> <span class="c"># don&#39;t forget the first one</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">numerator</span><span class="p">))</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">denominator</span><span class="p">)):</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></code></pre></div>

<p>Running time on machine:</p>

<div class="highlight"><pre><code class="language-text" data-lang="text">real    0m0.462s
user    0m0.457s
sys     0m0.003s</code></pre></div>

<h2 id="improvement">Improvement</h2>
<p>By analysing the pattern between the different (final) terms of the serie (<script type="math/tex"> \frac{3}{2}, \frac{7}{5}, \frac{17}{12}... </script>), we can notice that the numerators and denominators follow a simple relation (simultaneous update):</p>

<script type="math/tex; mode=display"> next\_numerator = 2 * prev\_denominator + prev\_numerator </script>

<script type="math/tex; mode=display"> next\_denominator = prev\_numerator + prev\_denominator </script>

<p>For instance, <script type="math/tex"> 7 = 2*2 + 3 </script> and <script type="math/tex"> 5 = 3 + 2 </script>.</p>

<p>Written in Python:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">res</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1001</span><span class="p">):</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">d</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="n">d</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)):</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></code></pre></div>

<div class="highlight"><pre><code class="language-text" data-lang="text">real    0m0.036s
user    0m0.030s
sys     0m0.003s</code></pre></div>

<p>This ends up being a pretty good speed boost!</p>

<h2 id="another-approach">Another approach?</h2>
<p>I have been thinking of another approach to solve this problem, but could not come up with simpler code than the one mentioned above.</p>

<p>In both solutions, numbers get big pretty quickly and the calculations are made using big integers, which slows things down but at the same time seems to be inevitable.</p>

<p>Any idea? Feel free to share!</p>


<div id="disqus_thread"></div>

<script type="text/javascript">
    var disqus_shortname = 'jtzp4'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

  </div>
</div>

<hr>

  <div class="row col-md-12 col-xs-18 col-sm-12">
    <p><small>By <a href="#top">Jeremy Tuloup</a> &ndash; 2015 &ndash; Theme by <a href="http://bootswatch.com/">bootswatch</a> </small></p>
  </div>

  </div> <!-- /container -->

  <script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

  <script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min.js"></script>

  <script>
    var scripts = document.getElementsByTagName("script");
    for (var i = 0; i < scripts.length; i++) {
      /* TODO: keep going after an individual parse error. */
      var script = scripts[i];
      if (script.type.match(/^math\/tex/)) {
        var text = script.text === "" ? script.innerHTML : script.text;
        var options = script.type.match(/mode\s*=\s*display/) ?
                      {displayMode: true} : {};
        script.insertAdjacentHTML("beforebegin",
                                  katex.renderToString(text, options));
      }
    }
    document.body.className += " math_finished";
  </script>

  <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>

  <script type="text/javascript">
    try {
      var pageTracker = _gat._getTracker("UA-51952511-1");
      pageTracker._trackPageview();
    } catch(err) {}
  </script>

  </body>
</html>
